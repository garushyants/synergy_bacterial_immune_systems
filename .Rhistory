color=system))+
facet_wrap(~Phage, nrow = 1)+
ylab("AUC")+
xlab("MOI(log10)")+
theme_classic()+
theme(strip.background = element_blank(),
strip.text = element_text(face = "bold"))+
scale_color_manual(values=legendcolors)+
scale_fill_manual(values=legendcolors)
return(AUCPlotWithConf)
}
confidenceinterval<-.95
DZAUCMeanPlot<-getAUCMeanplot(DZfull,"DZ",ci=confidenceinterval)
IZAUCMeanPlot<-getAUCMeanplot(IZfull,"IZ",ci=confidenceinterval)
GTAUCMeanPlot<-getAUCMeanplot(GTfull,"GT",ci=confidenceinterval)
DZAUCMeanPlot
getAUCMeanplot<-function(Df,System,maxobs=maxmin,ci)
{
DZadj<-filterFullDf(Df)
DZadjGrowth<-DZadj[,c(2:(ncol(DZadj)-4))]-DZadj[,c(1)]
DZadjGrowthMin<-DZadjGrowth[,c(1:which(colnames(DZadjGrowth)==toString(maxobs)))]
DZadjNoNeg<-DZadjGrowthMin
DZadjNoNeg[DZadjNoNeg<0]<-0
DZadjNoNegMult<-5*DZadjNoNeg
DZadjNoNegMult$AUC<-rowSums(DZadjNoNegMult)
DZAUCDf<-DZadj[,c((ncol(DZadj)-3):(ncol(DZadj)))]
DZAUCDf$AUC<-DZadjNoNegMult$AUC
#Calculate Expected sum
DZAUCDfwide<-spread(DZAUCDf,system,AUC)
DZAUCDfwide$AdditivExp<-DZAUCDfwide[,4]+DZAUCDfwide[,6]
AdditivExpMeanSD<-DZAUCDfwide %>% group_by(Phage,MOI) %>%
summarise(Mean=mean(AdditivExp),
SD=sd(AdditivExp))
AdditivExpMeanSD$system<-rep("Expected", length(AdditivExpMeanSD$Phage))
###function to calculate confidence intervals
GetConfidenceInterval<-function(Df,r=3,confint=ci)
{
Df$error<-qt(confint,df=(r-1))*Df$SD/sqrt(r)
Df$upper<-Df$Mean+Df$error
Df$lower<-Df$Mean-Df$error
return(Df)
}
###
AdditivExpForPlot<-GetConfidenceInterval(AdditivExpMeanSD)
##Calculate mean over replicates
DZAUCDfMean<-DZAUCDf %>% group_by(Phage,MOI,system)%>%
summarise(Mean=mean(AUC),
SD=sd(AUC))
DZAUCForPlot<-GetConfidenceInterval(DZAUCDfMean)
#Actually now I have all the controls for induvidual systems and pairs of systems
#But I am only using the ones for pairs because they all are similar
#I need supplementary figure comparing controls
ControlsSys<-subset(ControlsLong, ControlsLong$system == System)
ControlSysLim<-subset(ControlsSys,as.numeric(as.character(ControlsSys$Time)) <= maxobs)
ControlSysLimWide<-spread(ControlSysLim[,c(1:4)],Time,OD)
ControlSysLimWideGrowth<-ControlSysLimWide[,c(4:ncol(ControlSysLimWide))]-
ControlSysLimWide[,c(3)]
ControlSysLimWideGrowth[ControlSysLimWideGrowth<0]<-0
ControlMult<-5*ControlSysLimWideGrowth
ControlMult$AUC<-rowSums(ControlMult)
ControlMean<-mean(ControlMult$AUC)
ControlSD<-sd(ControlMult$AUC)
PreplotControlDf<-AdditivExpForPlot[,c("Phage","MOI")]
PreplotControlDf$Mean<-rep(ControlMean,length(AdditivExpForPlot$Phage))
PreplotControlDf$SD=rep(ControlSD,length(AdditivExpForPlot$Phage))
PreplotControlDf$system<-rep("Control",length(AdditivExpForPlot$Phage))
ControlDfForPlot<-GetConfidenceInterval(PreplotControlDf)
ForPlot<-rbind(AdditivExpForPlot,ControlDfForPlot,DZAUCForPlot)
ForPlot$logMOI<-log10(as.double(ForPlot$MOI))
##Plot results
#Select colors
legendcolors<-c("#d95f02","#1b9e77","#7570b3","black","grey")
names(legendcolors)<-c(colnames(DZAUCDfwide)[4:6],"Expected","Control")
#Plot
AUCPlotWithConf<-ggplot(data=ForPlot)+
geom_ribbon(aes(x=logMOI,ymin=lower,ymax=upper, fill=system,
color=system),
linewidth=0.1,
alpha=0.2)+
geom_line(aes(x=logMOI, y=Mean,
color=system),
linewidth=0.5,
linetype="dotted")+
facet_wrap(~Phage, nrow = 1)+
ylab("AUC")+
xlab("MOI(log10)")+
theme_classic()+
theme(strip.background = element_blank(),
strip.text = element_text(face = "bold"))+
scale_color_manual(values=legendcolors)+
scale_fill_manual(values=legendcolors)
return(AUCPlotWithConf)
}
confidenceinterval<-.95
DZAUCMeanPlot<-getAUCMeanplot(DZfull,"DZ",ci=confidenceinterval)
DZAUCMeanPlot
getAUCMeanplot<-function(Df,System,maxobs=maxmin,ci)
{
DZadj<-filterFullDf(Df)
DZadjGrowth<-DZadj[,c(2:(ncol(DZadj)-4))]-DZadj[,c(1)]
DZadjGrowthMin<-DZadjGrowth[,c(1:which(colnames(DZadjGrowth)==toString(maxobs)))]
DZadjNoNeg<-DZadjGrowthMin
DZadjNoNeg[DZadjNoNeg<0]<-0
DZadjNoNegMult<-5*DZadjNoNeg
DZadjNoNegMult$AUC<-rowSums(DZadjNoNegMult)
DZAUCDf<-DZadj[,c((ncol(DZadj)-3):(ncol(DZadj)))]
DZAUCDf$AUC<-DZadjNoNegMult$AUC
#Calculate Expected sum
DZAUCDfwide<-spread(DZAUCDf,system,AUC)
DZAUCDfwide$AdditivExp<-DZAUCDfwide[,4]+DZAUCDfwide[,6]
AdditivExpMeanSD<-DZAUCDfwide %>% group_by(Phage,MOI) %>%
summarise(Mean=mean(AdditivExp),
SD=sd(AdditivExp))
AdditivExpMeanSD$system<-rep("Expected", length(AdditivExpMeanSD$Phage))
###function to calculate confidence intervals
GetConfidenceInterval<-function(Df,r=3,confint=ci)
{
Df$error<-qt(confint,df=(r-1))*Df$SD/sqrt(r)
Df$upper<-Df$Mean+Df$error
Df$lower<-Df$Mean-Df$error
return(Df)
}
###
AdditivExpForPlot<-GetConfidenceInterval(AdditivExpMeanSD)
##Calculate mean over replicates
DZAUCDfMean<-DZAUCDf %>% group_by(Phage,MOI,system)%>%
summarise(Mean=mean(AUC),
SD=sd(AUC))
DZAUCForPlot<-GetConfidenceInterval(DZAUCDfMean)
#Actually now I have all the controls for induvidual systems and pairs of systems
#But I am only using the ones for pairs because they all are similar
#I need supplementary figure comparing controls
ControlsSys<-subset(ControlsLong, ControlsLong$system == System)
ControlSysLim<-subset(ControlsSys,as.numeric(as.character(ControlsSys$Time)) <= maxobs)
ControlSysLimWide<-spread(ControlSysLim[,c(1:4)],Time,OD)
ControlSysLimWideGrowth<-ControlSysLimWide[,c(4:ncol(ControlSysLimWide))]-
ControlSysLimWide[,c(3)]
ControlSysLimWideGrowth[ControlSysLimWideGrowth<0]<-0
ControlMult<-5*ControlSysLimWideGrowth
ControlMult$AUC<-rowSums(ControlMult)
ControlMean<-mean(ControlMult$AUC)
ControlSD<-sd(ControlMult$AUC)
PreplotControlDf<-AdditivExpForPlot[,c("Phage","MOI")]
PreplotControlDf$Mean<-rep(ControlMean,length(AdditivExpForPlot$Phage))
PreplotControlDf$SD=rep(ControlSD,length(AdditivExpForPlot$Phage))
PreplotControlDf$system<-rep("Control",length(AdditivExpForPlot$Phage))
ControlDfForPlot<-GetConfidenceInterval(PreplotControlDf)
ForPlot<-rbind(AdditivExpForPlot,ControlDfForPlot,DZAUCForPlot)
ForPlot$logMOI<-log10(as.double(ForPlot$MOI))
##Plot results
#Select colors
legendcolors<-c("#d95f02","#1b9e77","#7570b3","black","grey")
names(legendcolors)<-c(colnames(DZAUCDfwide)[4:6],"Expected","Control")
#Plot
AUCPlotWithConf<-ggplot(data=ForPlot)+
geom_ribbon(aes(x=logMOI,ymin=lower,ymax=upper, fill=system,
color=system),
linewidth=0.1,
alpha=0.2)+
geom_line(aes(x=logMOI, y=Mean,
color=system),
linewidth=0.5,
linetype="dotted")+
geom_point(aes(x=logMOI, y=Mean,
color=system),
shape=16)+
facet_wrap(~Phage, nrow = 1)+
ylab("AUC")+
xlab("MOI(log10)")+
theme_classic()+
theme(strip.background = element_blank(),
strip.text = element_text(face = "bold"))+
scale_color_manual(values=legendcolors)+
scale_fill_manual(values=legendcolors)
return(AUCPlotWithConf)
}
confidenceinterval<-.95
DZAUCMeanPlot<-getAUCMeanplot(DZfull,"DZ",ci=confidenceinterval)
IZAUCMeanPlot<-getAUCMeanplot(IZfull,"IZ",ci=confidenceinterval)
GTAUCMeanPlot<-getAUCMeanplot(GTfull,"GT",ci=confidenceinterval)
DZAUCMeanPlot
getAUCMeanplot<-function(Df,System,maxobs=maxmin,ci)
{
DZadj<-filterFullDf(Df)
DZadjGrowth<-DZadj[,c(2:(ncol(DZadj)-4))]-DZadj[,c(1)]
DZadjGrowthMin<-DZadjGrowth[,c(1:which(colnames(DZadjGrowth)==toString(maxobs)))]
DZadjNoNeg<-DZadjGrowthMin
DZadjNoNeg[DZadjNoNeg<0]<-0
DZadjNoNegMult<-5*DZadjNoNeg
DZadjNoNegMult$AUC<-rowSums(DZadjNoNegMult)
DZAUCDf<-DZadj[,c((ncol(DZadj)-3):(ncol(DZadj)))]
DZAUCDf$AUC<-DZadjNoNegMult$AUC
#Calculate Expected sum
DZAUCDfwide<-spread(DZAUCDf,system,AUC)
DZAUCDfwide$AdditivExp<-DZAUCDfwide[,4]+DZAUCDfwide[,6]
AdditivExpMeanSD<-DZAUCDfwide %>% group_by(Phage,MOI) %>%
summarise(Mean=mean(AdditivExp),
SD=sd(AdditivExp))
AdditivExpMeanSD$system<-rep("Expected", length(AdditivExpMeanSD$Phage))
###function to calculate confidence intervals
GetConfidenceInterval<-function(Df,r=3,confint=ci)
{
Df$error<-qt(confint,df=(r-1))*Df$SD/sqrt(r)
Df$upper<-Df$Mean+Df$error
Df$lower<-Df$Mean-Df$error
return(Df)
}
###
AdditivExpForPlot<-GetConfidenceInterval(AdditivExpMeanSD)
##Calculate mean over replicates
DZAUCDfMean<-DZAUCDf %>% group_by(Phage,MOI,system)%>%
summarise(Mean=mean(AUC),
SD=sd(AUC))
DZAUCForPlot<-GetConfidenceInterval(DZAUCDfMean)
#Actually now I have all the controls for induvidual systems and pairs of systems
#But I am only using the ones for pairs because they all are similar
#I need supplementary figure comparing controls
ControlsSys<-subset(ControlsLong, ControlsLong$system == System)
ControlSysLim<-subset(ControlsSys,as.numeric(as.character(ControlsSys$Time)) <= maxobs)
ControlSysLimWide<-spread(ControlSysLim[,c(1:4)],Time,OD)
ControlSysLimWideGrowth<-ControlSysLimWide[,c(4:ncol(ControlSysLimWide))]-
ControlSysLimWide[,c(3)]
ControlSysLimWideGrowth[ControlSysLimWideGrowth<0]<-0
ControlMult<-5*ControlSysLimWideGrowth
ControlMult$AUC<-rowSums(ControlMult)
ControlMean<-mean(ControlMult$AUC)
ControlSD<-sd(ControlMult$AUC)
PreplotControlDf<-AdditivExpForPlot[,c("Phage","MOI")]
PreplotControlDf$Mean<-rep(ControlMean,length(AdditivExpForPlot$Phage))
PreplotControlDf$SD=rep(ControlSD,length(AdditivExpForPlot$Phage))
PreplotControlDf$system<-rep("Control",length(AdditivExpForPlot$Phage))
ControlDfForPlot<-GetConfidenceInterval(PreplotControlDf)
ForPlot<-rbind(AdditivExpForPlot,ControlDfForPlot,DZAUCForPlot)
ForPlot$logMOI<-log10(as.double(ForPlot$MOI))
##Plot results
#Select colors
legendcolors<-c("#d95f02","#1b9e77","#7570b3","black","grey")
names(legendcolors)<-c(colnames(DZAUCDfwide)[4:6],"Expected","Control")
#Plot
AUCPlotWithConf<-ggplot(data=ForPlot)+
geom_ribbon(aes(x=logMOI,ymin=lower,ymax=upper, fill=system,
color=system),
linewidth=0.1,
alpha=0.2)+
geom_line(aes(x=logMOI, y=Mean,
color=system),
linewidth=0.3,
linetype="dotted")+
geom_point(aes(x=logMOI, y=Mean,
color=system),
shape=16)+
facet_wrap(~Phage, nrow = 1)+
ylab("AUC")+
xlab("MOI(log10)")+
theme_classic()+
theme(strip.background = element_blank(),
strip.text = element_text(face = "bold"))+
scale_color_manual(values=legendcolors)+
scale_fill_manual(values=legendcolors)
return(AUCPlotWithConf)
}
confidenceinterval<-.95
DZAUCMeanPlot<-getAUCMeanplot(DZfull,"DZ",ci=confidenceinterval)
IZAUCMeanPlot<-getAUCMeanplot(IZfull,"IZ",ci=confidenceinterval)
GTAUCMeanPlot<-getAUCMeanplot(GTfull,"GT",ci=confidenceinterval)
DZAUCMeanPlot
ggsave(paste("LiquidAssay_DZ_AUCMean_",minfrst,"_ci_",confidenceinterval,".png", sep=""),
plot=DZAUCMeanPlot,
path=folderForResults,
height=8, width=35, dpi=300, units ="cm")
ggsave(paste("LiquidAssay_DZ_AUCMean_",maxmin,"_ci_",confidenceinterval,".png", sep=""),
plot=DZAUCMeanPlot,
path=folderForResults,
height=8, width=35, dpi=300, units ="cm")
IKAUCMeanPlot<-getAUCMeanplot(IKfull,"IK",ci=confidenceinterval)
ggsave(paste("LiquidAssay_DZ_AUCMean_",maxmin,"_ci_",confidenceinterval,".svg", sep=""),
plot=DZAUCMeanPlot,
path=folderForResults,
height=8, width=35, dpi=300, units ="cm")
ggsave(paste("LiquidAssay_IZ_AUCMean_",maxmin,"_ci_",confidenceinterval,".svg", sep=""),
plot=IZAUCMeanPlot,
path=folderForResults,
height=8, width=35, dpi=300, units ="cm")
ggsave(paste("LiquidAssay_GT_AUCMean_",maxmin,"_ci_",confidenceinterval,".svg", sep=""),
plot=GTAUCMeanPlot,
path=folderForResults,
height=8, width=35, dpi=300, units ="cm")
ggsave(paste("LiquidAssay_IK_AUCMean_",maxmin,"_ci_",confidenceinterval,".svg", sep=""),
plot=IKAUCMeanPlot,
path=folderForResults,
height=8, width=35, dpi=300, units ="cm")
ggsave(paste("LiquidAssay_DZ_AUCMean_",maxmin,"_ci_",confidenceinterval,".png", sep=""),
plot=DZAUCMeanPlot,
path=folderForResults,
height=8, width=35, dpi=300, units ="cm")
ggsave(paste("LiquidAssay_IZ_AUCMean_",maxmin,"_ci_",confidenceinterval,".png", sep=""),
plot=IZAUCMeanPlot,
path=folderForResults,
height=8, width=35, dpi=300, units ="cm")
ggsave(paste("LiquidAssay_GT_AUCMean_",maxmin,"_ci_",confidenceinterval,".png", sep=""),
plot=GTAUCMeanPlot,
path=folderForResults,
height=8, width=35, dpi=300, units ="cm")
ggsave(paste("LiquidAssay_IK_AUCMean_",maxmin,"_ci_",confidenceinterval,".png", sep=""),
plot=IKAUCMeanPlot,
path=folderForResults,
height=8, width=35, dpi=300, units ="cm")
getAUCMeanplot<-function(Df,System,maxobs=maxmin,ci)
{
DZadj<-filterFullDf(Df)
DZadjGrowth<-DZadj[,c(2:(ncol(DZadj)-4))]-DZadj[,c(1)]
DZadjGrowthMin<-DZadjGrowth[,c(1:which(colnames(DZadjGrowth)==toString(maxobs)))]
DZadjNoNeg<-DZadjGrowthMin
DZadjNoNeg[DZadjNoNeg<0]<-0
DZadjNoNegMult<-5*DZadjNoNeg
DZadjNoNegMult$AUC<-rowSums(DZadjNoNegMult)
DZAUCDf<-DZadj[,c((ncol(DZadj)-3):(ncol(DZadj)))]
DZAUCDf$AUC<-DZadjNoNegMult$AUC
#Calculate Expected sum
DZAUCDfwide<-spread(DZAUCDf,system,AUC)
DZAUCDfwide$AdditivExp<-DZAUCDfwide[,4]+DZAUCDfwide[,6]
AdditivExpMeanSD<-DZAUCDfwide %>% group_by(Phage,MOI) %>%
summarise(Mean=mean(AdditivExp),
SD=sd(AdditivExp))
AdditivExpMeanSD$system<-rep("Expected", length(AdditivExpMeanSD$Phage))
###function to calculate confidence intervals
GetConfidenceInterval<-function(Df,r=3,confint=ci)
{
Df$error<-qt(confint,df=(r-1))*Df$SD/sqrt(r)
Df$upper<-Df$Mean+Df$error
Df$lower<-Df$Mean-Df$error
return(Df)
}
###
AdditivExpForPlot<-GetConfidenceInterval(AdditivExpMeanSD)
##Calculate mean over replicates
DZAUCDfMean<-DZAUCDf %>% group_by(Phage,MOI,system)%>%
summarise(Mean=mean(AUC),
SD=sd(AUC))
DZAUCForPlot<-GetConfidenceInterval(DZAUCDfMean)
#Actually now I have all the controls for induvidual systems and pairs of systems
#But I am only using the ones for pairs because they all are similar
#I need supplementary figure comparing controls
ControlsSys<-subset(ControlsLong, ControlsLong$system == System)
ControlSysLim<-subset(ControlsSys,as.numeric(as.character(ControlsSys$Time)) <= maxobs)
ControlSysLimWide<-spread(ControlSysLim[,c(1:4)],Time,OD)
ControlSysLimWideGrowth<-ControlSysLimWide[,c(4:ncol(ControlSysLimWide))]-
ControlSysLimWide[,c(3)]
ControlSysLimWideGrowth[ControlSysLimWideGrowth<0]<-0
ControlMult<-5*ControlSysLimWideGrowth
ControlMult$AUC<-rowSums(ControlMult)
ControlMean<-mean(ControlMult$AUC)
ControlSD<-sd(ControlMult$AUC)
PreplotControlDf<-AdditivExpForPlot[,c("Phage","MOI")]
PreplotControlDf$Mean<-rep(ControlMean,length(AdditivExpForPlot$Phage))
PreplotControlDf$SD=rep(ControlSD,length(AdditivExpForPlot$Phage))
PreplotControlDf$system<-rep("Control",length(AdditivExpForPlot$Phage))
ControlDfForPlot<-GetConfidenceInterval(PreplotControlDf)
ForPlot<-rbind(AdditivExpForPlot,ControlDfForPlot,DZAUCForPlot)
ForPlot$logMOI<-log10(as.double(ForPlot$MOI))
##Plot results
#Select colors
legendcolors<-c("#d95f02","#1b9e77","#7570b3","black","grey")
names(legendcolors)<-c(colnames(DZAUCDfwide)[4:6],"Expected Additive","Control")
#Plot
AUCPlotWithConf<-ggplot(data=ForPlot)+
geom_ribbon(aes(x=logMOI,ymin=lower,ymax=upper, fill=system,
color=system),
linewidth=0.1,
alpha=0.2)+
geom_line(aes(x=logMOI, y=Mean,
color=system),
linewidth=0.3,
linetype="dotted")+
geom_point(aes(x=logMOI, y=Mean,
color=system),
shape=16)+
facet_wrap(~Phage, nrow = 1)+
ylab("AUC")+
xlab("MOI(log10)")+
theme_classic()+
theme(strip.background = element_blank(),
strip.text = element_text(face = "bold"))+
scale_color_manual(values=legendcolors)+
scale_fill_manual(values=legendcolors)
return(AUCPlotWithConf)
}
confidenceinterval<-.95
DZAUCMeanPlot<-getAUCMeanplot(DZfull,"DZ",ci=confidenceinterval)
IZAUCMeanPlot<-getAUCMeanplot(IZfull,"IZ",ci=confidenceinterval)
GTAUCMeanPlot<-getAUCMeanplot(GTfull,"GT",ci=confidenceinterval)
IKAUCMeanPlot<-getAUCMeanplot(IKfull,"IK",ci=confidenceinterval)
DZAUCMeanPlot
getAUCMeanplot<-function(Df,System,maxobs=maxmin,ci)
{
DZadj<-filterFullDf(Df)
DZadjGrowth<-DZadj[,c(2:(ncol(DZadj)-4))]-DZadj[,c(1)]
DZadjGrowthMin<-DZadjGrowth[,c(1:which(colnames(DZadjGrowth)==toString(maxobs)))]
DZadjNoNeg<-DZadjGrowthMin
DZadjNoNeg[DZadjNoNeg<0]<-0
DZadjNoNegMult<-5*DZadjNoNeg
DZadjNoNegMult$AUC<-rowSums(DZadjNoNegMult)
DZAUCDf<-DZadj[,c((ncol(DZadj)-3):(ncol(DZadj)))]
DZAUCDf$AUC<-DZadjNoNegMult$AUC
#Calculate Expected sum
DZAUCDfwide<-spread(DZAUCDf,system,AUC)
DZAUCDfwide$AdditivExp<-DZAUCDfwide[,4]+DZAUCDfwide[,6]
AdditivExpMeanSD<-DZAUCDfwide %>% group_by(Phage,MOI) %>%
summarise(Mean=mean(AdditivExp),
SD=sd(AdditivExp))
AdditivExpMeanSD$system<-rep("Expected", length(AdditivExpMeanSD$Phage))
###function to calculate confidence intervals
GetConfidenceInterval<-function(Df,r=3,confint=ci)
{
Df$error<-qt(confint,df=(r-1))*Df$SD/sqrt(r)
Df$upper<-Df$Mean+Df$error
Df$lower<-Df$Mean-Df$error
return(Df)
}
###
AdditivExpForPlot<-GetConfidenceInterval(AdditivExpMeanSD)
##Calculate mean over replicates
DZAUCDfMean<-DZAUCDf %>% group_by(Phage,MOI,system)%>%
summarise(Mean=mean(AUC),
SD=sd(AUC))
DZAUCForPlot<-GetConfidenceInterval(DZAUCDfMean)
#Actually now I have all the controls for induvidual systems and pairs of systems
#But I am only using the ones for pairs because they all are similar
#I need supplementary figure comparing controls
ControlsSys<-subset(ControlsLong, ControlsLong$system == System)
ControlSysLim<-subset(ControlsSys,as.numeric(as.character(ControlsSys$Time)) <= maxobs)
ControlSysLimWide<-spread(ControlSysLim[,c(1:4)],Time,OD)
ControlSysLimWideGrowth<-ControlSysLimWide[,c(4:ncol(ControlSysLimWide))]-
ControlSysLimWide[,c(3)]
ControlSysLimWideGrowth[ControlSysLimWideGrowth<0]<-0
ControlMult<-5*ControlSysLimWideGrowth
ControlMult$AUC<-rowSums(ControlMult)
ControlMean<-mean(ControlMult$AUC)
ControlSD<-sd(ControlMult$AUC)
PreplotControlDf<-AdditivExpForPlot[,c("Phage","MOI")]
PreplotControlDf$Mean<-rep(ControlMean,length(AdditivExpForPlot$Phage))
PreplotControlDf$SD=rep(ControlSD,length(AdditivExpForPlot$Phage))
PreplotControlDf$system<-rep("Control",length(AdditivExpForPlot$Phage))
ControlDfForPlot<-GetConfidenceInterval(PreplotControlDf)
ForPlot<-rbind(AdditivExpForPlot,ControlDfForPlot,DZAUCForPlot)
ForPlot$logMOI<-log10(as.double(ForPlot$MOI))
##Plot results
#Select colors
legendcolors<-c("#d95f02","#1b9e77","#7570b3","black","grey")
names(legendcolors)<-c(colnames(DZAUCDfwide)[4:6],"Expected","Control")
#Plot
AUCPlotWithConf<-ggplot(data=ForPlot)+
geom_ribbon(aes(x=logMOI,ymin=lower,ymax=upper, fill=system,
color=system),
linewidth=0.1,
alpha=0.2)+
geom_line(aes(x=logMOI, y=Mean,
color=system),
linewidth=0.3,
linetype="dotted")+
geom_point(aes(x=logMOI, y=Mean,
color=system),
shape=16)+
facet_wrap(~Phage, nrow = 1)+
ylab("AUC")+
xlab("MOI(log10)")+
theme_classic()+
theme(strip.background = element_blank(),
strip.text = element_text(face = "bold"))+
scale_color_manual(values=legendcolors)+
scale_fill_manual(values=legendcolors)
return(AUCPlotWithConf)
}
confidenceinterval<-.95
DZAUCMeanPlot<-getAUCMeanplot(DZfull,"DZ",ci=confidenceinterval)
IZAUCMeanPlot<-getAUCMeanplot(IZfull,"IZ",ci=confidenceinterval)
DZAUCMeanPlot
GTAUCMeanPlot<-getAUCMeanplot(GTfull,"GT",ci=confidenceinterval)
IKAUCMeanPlot<-getAUCMeanplot(IKfull,"IK",ci=confidenceinterval)
ggsave(paste("LiquidAssay_DZ_AUCMean_",maxmin,"_ci_",confidenceinterval,".svg", sep=""),
plot=DZAUCMeanPlot,
path=folderForResults,
height=8, width=35, dpi=300, units ="cm")
ggsave(paste("LiquidAssay_IZ_AUCMean_",maxmin,"_ci_",confidenceinterval,".svg", sep=""),
plot=IZAUCMeanPlot,
path=folderForResults,
height=8, width=35, dpi=300, units ="cm")
ggsave(paste("LiquidAssay_GT_AUCMean_",maxmin,"_ci_",confidenceinterval,".svg", sep=""),
plot=GTAUCMeanPlot,
path=folderForResults,
height=8, width=35, dpi=300, units ="cm")
ggsave(paste("LiquidAssay_IK_AUCMean_",maxmin,"_ci_",confidenceinterval,".svg", sep=""),
plot=IKAUCMeanPlot,
path=folderForResults,
height=8, width=35, dpi=300, units ="cm")
#
ggsave(paste("LiquidAssay_DZ_AUCMean_",maxmin,"_ci_",confidenceinterval,".png", sep=""),
plot=DZAUCMeanPlot,
path=folderForResults,
height=8, width=35, dpi=300, units ="cm")
ggsave(paste("LiquidAssay_IZ_AUCMean_",maxmin,"_ci_",confidenceinterval,".png", sep=""),
plot=IZAUCMeanPlot,
path=folderForResults,
height=8, width=35, dpi=300, units ="cm")
ggsave(paste("LiquidAssay_GT_AUCMean_",maxmin,"_ci_",confidenceinterval,".png", sep=""),
plot=GTAUCMeanPlot,
path=folderForResults,
height=8, width=35, dpi=300, units ="cm")
ggsave(paste("LiquidAssay_IK_AUCMean_",maxmin,"_ci_",confidenceinterval,".png", sep=""),
plot=IKAUCMeanPlot,
path=folderForResults,
height=8, width=35, dpi=300, units ="cm")
