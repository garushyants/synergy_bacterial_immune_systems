### Original code for Wu, Garushyants et al. "Synergistic anti-phage activity of bacterial immune systems"

#### **scripts**
Contain scripts to reproduce the analysis and vizualize data

*Ecoli_numContigs_vc_numDefence.R* builds correlation between number of contigs in genome and number of predicted immune systems

Scripts *Ecoli26k_tree_phylogroups_defense_systems.R* and *Visualize_phylogenetic_trees_orders.R* visualize phylognetic trees and add data to them.

*Ecoli_defsystems_presence_by_phylogroup.R* allows to analyze immune systems content in E. coli phylogroups and also performs enrichment analysis.

*defense_systems_content_vs_phylogenetic_distance.R* builds correlations between immune systems content and phylogenetic distance

*Pagel_calculate_sge_farm.R* is the main script to run the Pagel correlation test for the binary traits

*Pagel_visualization_Ecoli.R* and *Pagel_visualization_orders.R* calculate directionality of interactions for the significant results and visualize the data for 26k E. coli dataset and order level datasets accordingly.

*Pagel_all_datasets_igraph.R* builds graphs for Pagel results

*Pagel_compare_results_all_datasets.R* script that compares and vizualizes results of Pagel test for all five datasets

*Draw_trees_for_selected_pairs.R* visualizes phylogenetic trees for selected pairs of immune systems.

*positive_vs_negative_genome_distance.R* analyses genomic distances for the co-occuring immune systems pairs and compares it with background distributions

*104_plasmids_cactus_visualization.R* visualizes [Cactus](https://github.com/ComparativeGenomicsToolkit/cactus) output for 104 plasmids carrying tmn and Gabija systems

*SynergisticVsAntagonistic_4pairs.R* Analyses EOP and liquid assay experiments data for four pairs of immune systems: Zorya II + Druantia III, tmn + Gabija, Kiwa + ietAS, and ietAS + Zorya II

#### **data**
Contains data required to run the scripts above and some of the outputs

#### **figures**
This folder contains figures produced by scripts described above

*Ecoli_pagel_heatmap_pagel_0.005.png* main figure with Pagel correlation analysis results for 26k *E. coli* dataset

*[dataset]_heatmap_pagel_all_models_001.png* Pagel correlation analysis results for four order level datasets, where [dataset] can be either enter (*Enterobacteriales*) or burk (*Burkholderiales*) or baci (*Bacillales*) or pseu (*Pseudomonadales*)

*EOP_and_AUC* contains figures generated by SynergisticVsAntagonistic_4pairs.R

*Ecoli_numContigs_vs_numDefence* contains output of Ecoli_numContigs_vc_numDefence.R

*Ecoli_phylogenetic_trees* contains outputs of Ecoli26k_tree_phylogroups_defense_systems.R and Draw_trees_for_selected_pairs.R

*Ecoli_phylogroups* contains output of Ecoli_defsystems_presence_by_phylogroup.R

*all_datasets_interaction_graph* contains output of Pagel_all_datasets_igraph.R

*cooccurence_vs_genome_distance* contains output of positive_vs_negative_genome_distance.R

*defence_systems_vs_phylogenetic_distance* contains output of defense_systems_content_vs_phylogenetic_distance.R

*tmn_Gabija_plasmids* contains output of 104_plasmids_cactus_visualization.R









